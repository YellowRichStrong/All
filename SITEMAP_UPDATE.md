# 站点地图自动更新功能

本项目包含站点地图自动更新工具，可以帮助您轻松管理网站的sitemap.xml文件。

## 功能特点

- **手动更新模式**：立即生成最新的站点地图
- **自动监控模式**：定期检查文件变化并自动更新站点地图
- **自定义检查间隔**：可以设置监控服务的检查频率
- **文件变化检测**：智能检测网站文件的修改并更新相应条目
- **简单易用的界面**：提供命令行菜单方便操作

## 文件说明

- `auto_update_sitemap.py`：核心Python脚本，负责监控文件变化和更新站点地图
- `update_sitemap.sh`：便捷的shell脚本，提供交互式菜单操作界面
- `generate_comprehensive_sitemap.py`：现有的站点地图生成脚本
- `sitemap.xml`：生成的站点地图文件

## 快速开始

### 1. 准备工作

确保安装了必要的Python库：

```bash
pip3 install schedule
```

### 2. 使用方法

运行便捷的shell脚本：

```bash
./update_sitemap.sh
```

您将看到以下选项：

1) 手动更新站点地图一次
2) 启动自动监控服务（每小时更新）
3) 启动自动监控服务（自定义间隔）
4) 查看站点地图内容

选择相应的选项即可操作。

### 3. 直接使用Python脚本

您也可以直接使用Python脚本：

**手动更新模式**：
```bash
python3 auto_update_sitemap.py --manual
```

**自定义间隔自动监控**：
```bash
python3 auto_update_sitemap.py --interval 3600  # 每3600秒（1小时）检查一次
```

## 高级功能

### 自动监控服务

启动自动监控服务后，系统会：

1. 初始化所有HTML文件的修改时间记录
2. 立即生成最新的站点地图
3. 定期检查文件变化
4. 当检测到文件变化时，自动更新站点地图

### 文件变化检测

系统会监控以下位置的HTML文件：
- 网站根目录
- `tools` 子目录

当这些文件被修改时，站点地图会自动更新。

## 注意事项

1. 确保有足够的文件系统权限读取HTML文件和写入sitemap.xml
2. 自动监控服务需要保持运行，可以使用nohup或systemd等工具实现后台运行
3. 建议根据网站更新频率调整监控间隔，避免过于频繁的更新
4. 如果不需要自动监控功能，也可以只使用手动更新模式

## 故障排除

- **问题**：无法启动自动监控服务
  **解决方案**：确保已安装schedule库：`pip3 install schedule`

- **问题**：站点地图未更新
  **解决方案**：检查文件路径配置是否正确，以及是否有文件系统写入权限

- **问题**：服务意外停止
  **解决方案**：查看日志输出了解错误原因，可能需要增加错误处理或调整监控间隔

## 维护建议

1. 定期检查站点地图的准确性
2. 根据网站规模和更新频率，调整合适的监控间隔
3. 如果网站结构发生重大变化，可以手动运行一次更新以确保所有页面都被包含

## 示例

### 示例1：手动更新站点地图
```
./update_sitemap.sh
选择选项1
```

### 示例2：启动每日自动更新
```
python3 auto_update_sitemap.py --interval 86400
```

### 示例3：查看最近的站点地图更新
```
./update_sitemap.sh
选择选项4
```